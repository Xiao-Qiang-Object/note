#!/bin/bash
 
# Time    : ${DATE} ${TIME}
# Author  : ${USER}
# File    : ${NAME}.sh
# Describe:
#
# Change:
#
 
#打印日志
print_log()
{
    current_time=$(date "+%Y-%m-%d %H:%M:%S")
    echo "$current_time $@"
}
###############################################
 
startsec=$(date +%s)
 
source /data/etlscript/PUBLIC/SCRIPT/TOOL/scriptHelper.sh
## 解析参数
resoveJson $1
checkLogPath $task_name
exec &> $CMRH_DATAHUB_SCRIPT_LOG/$EXE_DATE/$task_name/$run_serial_no.log
 
#代码段 1 开始
 
#以下代码为beeline模板,用不到可删掉
job_path=$0
 
#set( $sh_directory_p = '${job_path%/*}' )
sh_directory=`echo $sh_directory_p`
#脚本名称
#set( $job_name_p = '${job_path##*/}' )
job_name=`echo $job_name_p`
#set( $job_name_p = '${job_name%.*}' )
job_name=`echo $job_name_p`
#set( $pdate_p = '${inc_start:0:4}"-"${inc_start:4:2}"-"${inc_start:6:2}' )
pdate=$pdate_p
 
hivejdbc="jdbc:hive2://${src_ip}:${src_port}"
 
print_log "job_path:$job_path"
print_log "sh_directory:$sh_directory"
print_log "job_name:$job_name"
print_log "hivejdbc:$hivejdbc"
print_log "pdate:$pdate"
print_log "hive_queue:$hive_queue"
 
beeline -u $hivejdbc -n $src_user -p $src_password -e "
    SET mapred.job.queue.name=${hive_queue};
    SET MAPRED.JOB.NAME=${job_name};
    -- 具体逻辑SQL
 
 
 
 
    -- 统一删除临时表
 
"
 
#代码段 1 结束
exitCodeCheck $? $startsec $run_serial_no $task_name
 
#=========================================
 
#代码段 2 开始
 
#代码段 2 结束
exitCodeCheck $? $startsec $run_serial_no $task_name
 
 
#===============脚本任务结束===============
endsec=$(date +%s)
message="脚本耗时: $[ endsec-startsec ] 秒"
echo $message
 
# 回传状态给datahub
callDatahub 0 "$message" "$run_serial_no" "$task_name"
